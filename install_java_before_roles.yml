- name: OpenJDK 18 installation on linux
  hosts: twinpeaks
  become: true
  become_method: su
  tasks:
          - name: Download the openjdk package
            get_url:
                  url: https://download.java.net/java/GA/jdk18.0.2.1/db379da656dc47308e138f21b33976fa/1/GPL/openjdk-18.0.2.1_linux-x64_bin.tar.gz
                  dest: /home/admin12345/openjdk-18.0.2.1_linux-x64_bin.tar.gz

          - name : Unzip the package
            unarchive:
                    src: /home/admin12345/openjdk-18.0.2.1_linux-x64_bin.tar.gz
                    dest: /home/admin12345
                    remote_src: yes

          - name: JAVA_HOME settings
            lineinfile:
                    path: /etc/profile
                    state: present
                    line: "{{ item }}"
            with_items:
                   - 'export JAVA_HOME="/home/admin12345/jdk-18.0.2.1"'
                   - 'export PATH=$PATH:$JAVA_HOME/bin'

          - name: Reload /etc/profile
            shell: source /etc/profile
            register: output
            args:
                    executable: /bin/bash

          - debug: 'msg="{{ output }}"'

          - name: Unconditionally reboot the machine with all defaults
            reboot: 